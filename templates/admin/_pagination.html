<div class="pagination-controls">
    <div class="pagination-links">
        {% if pagination.total_pages > 1 %}
        {% if pagination.has_prev %}
        <a href="{{ url_for(request.endpoint, page=1, **search_params) }}" class="page-link nav-link">&laquo; First</a>
        <a href="{{ url_for(request.endpoint, page=pagination.page - 1, **search_params) }}"
            class="page-link nav-link">&lsaquo; Prev</a>
        {% endif %}

        {% set start_page = [1, pagination.page - 2] | max %}
        {% set end_page = [pagination.total_pages, pagination.page + 2] | min %}

        {% if start_page > 1 %}<span class="page-link">...</span>{% endif %}

        {% for p in range(start_page, end_page + 1) %}
        {% if p == pagination.page %}<span class="page-link current">{{ p }}</span>
        {% else %}<a href="{{ url_for(request.endpoint, page=p, **search_params) }}" class="page-link">{{ p
            }}</a>
        {% endif %}{% endfor %}

        {% if end_page < pagination.total_pages %}<span class="page-link">...</span>{% endif %}

            {% if pagination.has_next %}
            <a href="{{ url_for(request.endpoint, page=pagination.page + 1, **search_params) }}"
                class="page-link nav-link">Next &rsaquo;</a>
            <a href="{{ url_for(request.endpoint, page=pagination.total_pages, **search_params) }}"
                class="page-link nav-link">Last &raquo;</a>
            {% endif %}
            {% endif %}
    </div>
    <select class="per-page-select" onchange="location = this.value;">
        {% for num in [15, 30, 50, 100] %}<option
            value="{{ url_for(request.endpoint, per_page=num, **search_params_for_per_page) }}" {% if
            pagination.per_page==num %}selected{% endif %}>{{ num }} / page</option>{% endfor %}
    </select>
</div>